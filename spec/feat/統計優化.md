# çµ±è¨ˆé é¢å„ªåŒ– åŠŸèƒ½è¦æ ¼æ›¸

## 1. åŠŸèƒ½æ¦‚è¿°
é‡å°çµ±è¨ˆé é¢çš„ã€Œæ•¸æ“šæ´å¯ŸåŠ›ã€èˆ‡ã€Œè¦–è¦ºæ˜“è®€æ€§ã€é€²è¡Œå…¨é¢å„ªåŒ–ï¼Œæå‡ç”¨æˆ¶å°å……é›»æ•¸æ“šçš„ç†è§£èˆ‡åˆ†æèƒ½åŠ›ã€‚

## 2. ç¾æ³åˆ†æ

### 2.1 ç›®å‰ç‹€æ…‹
- **é ‚éƒ¨å¡ç‰‡å€**ï¼šç¸½å……é›»é‡ã€ç¸½è²»ç”¨ã€ç¸½é‡Œç¨‹ã€å¹³å‡é›»è€—ï¼ˆ4 å¼µå¡ç‰‡ï¼‰
- **ä¸­æ®µåœ–è¡¨å€**ï¼š
  - æœˆåº¦å……é›»é‡æ¢ç‹€åœ–ï¼ˆåƒ…é¡¯ç¤º kWhï¼‰
  - é›»è€—æ•ˆç‡ vs è²»ç”¨è¶¨å‹¢æ•£é»åœ–ï¼ˆX è»¸ç‚ºé›»è€—ã€Y è»¸ç‚ºè²»ç”¨ï¼‰
- **ç¯©é¸åŠŸèƒ½**ï¼šå¹´ä»½é¸æ“‡ã€æ™‚é–“ç¯„åœé¸æ“‡

### 2.2 ä¸»è¦å•é¡Œ
| å•é¡Œ | èªªæ˜ |
|------|------|
| åº•éƒ¨åœ–è¡¨é‚è¼¯æ··äº‚ | X è»¸é¡¯ç¤ºé›»è€—æ•¸å€¼ä½†è³‡æ–™é»æ¨™è¨»æ—¥æœŸï¼Œç”¨æˆ¶é›£ä»¥åˆ¤æ–·æ˜¯æ™‚é–“è»¸é‚„æ˜¯æ•£ä½ˆåœ– |
| ç¼ºå°‘é—œéµæŒ‡æ¨™ | ç¼ºå°‘ã€Œæ¯å…¬é‡Œæˆæœ¬ã€é€™å€‹è»Šä¸»æœ€é—œå¿ƒçš„æŒ‡æ¨™ |
| åœ–è¡¨å–®ä¸€ç¶­åº¦ | æœˆåº¦å……é›»é‡åƒ…é¡¯ç¤º kWhï¼Œç„¡æ³•å°æ¯”è²»ç”¨èˆ‡å……é›»ä¾†æº |
| ç¼ºå°‘å……é›»ä¾†æºåˆ†æ | ç„¡æ³•å€åˆ† ACï¼ˆå®¶å……ï¼‰èˆ‡ DCï¼ˆè¶…å……ï¼‰çš„æ¯”ä¾‹ |
| ç•°å¸¸å€¼ä¸æ˜é¡¯ | é›»è€—æ³¢å‹•å¤§æ™‚ç„¡æ³•å¿«é€Ÿè­˜åˆ¥ç•°å¸¸é» |

---

## 3. å„ªåŒ–é …ç›®æ¸…å–®

| å„ªå…ˆç´š | é …ç›® | èªªæ˜ | ç‹€æ…‹ |
|--------|------|------|------|
| P0 | ä¿®æ­£åº•éƒ¨åœ–è¡¨é‚è¼¯ | æ‹†åˆ†ç‚ºç¨ç«‹çš„ã€Œé›»è€—è¶¨å‹¢åœ–ã€èˆ‡ã€Œæ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢ã€ | âœ… å®Œæˆ |
| P0 | æ–°å¢ã€Œæ¯å…¬é‡Œæˆæœ¬ã€æŒ‡æ¨™ | åœ¨å¡ç‰‡å€æ–°å¢ $/km æŒ‡æ¨™ | âœ… å®Œæˆ |
| P1 | å„ªåŒ–æœˆåº¦å……é›»é‡åœ–è¡¨ | æ”¯æ´åˆ‡æ›é¡¯ç¤ºåº¦æ•¸/è²»ç”¨ï¼Œæˆ–æ”¹ç‚ºå †ç–Šé•·æ¢åœ– | âœ… å®Œæˆ |
| P1 | æ–°å¢å……é›»ä¾†æºåˆ†æ | AC vs DC æ¯”ä¾‹åœ“é¤…åœ– | âœ… å®Œæˆ |
| P2 | ç•°å¸¸å€¼æ¨™è¨»åŠŸèƒ½ | åœ¨åœ–è¡¨ä¸Šæ¨™è¨˜ç•°å¸¸é›»è€—é» | âœ… å®Œæˆ |
| P2 | å„€è¡¨æ¿ä½ˆå±€èª¿æ•´ | æ•´é«”ç‰ˆé¢å„ªåŒ– | âœ… å®Œæˆ |

---

## 4. è©³ç´°è¦æ ¼

### 4.1 ä¿®æ­£åº•éƒ¨åœ–è¡¨é‚è¼¯ï¼ˆP0ï¼‰

#### 4.1.1 å•é¡Œæè¿°
ç›®å‰çš„ `EfficiencyVsCostChart` ä»¥é›»è€—å€¼ç‚º X è»¸ï¼Œè²»ç”¨ç‚º Y è»¸ï¼Œä¸¦ä»¥é›»è€—æ’åºé€£ç·šã€‚é€™é€ æˆï¼š
- é€£ç·šé †åºèˆ‡æ™‚é–“ç„¡é—œï¼Œç„¡æ³•å‘ˆç¾ã€Œè¶¨å‹¢ã€
- æ—¥æœŸæ¨™è¨»åœ¨æ•£ä½ˆé»ä¸Šï¼Œèˆ‡ X è»¸èªæ„è¡çª
- é›»è€—èˆ‡è²»ç”¨å…©å€‹ç¶­åº¦æ··åˆï¼Œé›£ä»¥è§£è®€

#### 4.1.2 è§£æ±ºæ–¹æ¡ˆ
**æ‹†åˆ†ç‚ºå…©å€‹ç¨ç«‹åœ–è¡¨**ï¼š

**åœ–è¡¨ Aï¼šé›»è€—æ•ˆç‡è¶¨å‹¢åœ–ï¼ˆTime Seriesï¼‰**
| é …ç›® | è¦æ ¼ |
|------|------|
| é¡å‹ | æŠ˜ç·šåœ– + é»ç‹€åœ– |
| X è»¸ | æ—¥æœŸï¼ˆæœˆä»½ï¼‰ï¼ŒæŒ‰æ™‚é–“é †åºæ’åˆ— |
| Y è»¸ | é›»è€—æ•ˆç‡ (km/kWh) |
| æ¨™é¡Œ | ã€Œé›»è€—æ•ˆç‡è¶¨å‹¢ã€ |
| ç”¨é€” | è§€å¯Ÿé›»è€—éš¨æ™‚é–“ï¼ˆå­£ç¯€ï¼‰çš„è®ŠåŒ– |

**åœ–è¡¨ Bï¼šæ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢åœ–ï¼ˆTime Seriesï¼‰**
| é …ç›® | è¦æ ¼ |
|------|------|
| é¡å‹ | æŠ˜ç·šåœ– + é»ç‹€åœ– |
| X è»¸ | æ—¥æœŸï¼ˆæœˆä»½ï¼‰ï¼ŒæŒ‰æ™‚é–“é †åºæ’åˆ— |
| Y è»¸ | æ¯å…¬é‡Œæˆæœ¬ ($/km) |
| æ¨™é¡Œ | ã€Œæ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢ã€ |
| ç”¨é€” | è§€å¯Ÿç”¨è»Šæˆæœ¬çš„è®ŠåŒ– |

#### 4.1.3 è¦–è¦ºè¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é›»è€—æ•ˆç‡è¶¨å‹¢                                           â”‚
â”‚                                                        â”‚
â”‚  km/kWh                                                â”‚
â”‚    6.0 â”¤        â—                                      â”‚
â”‚    5.5 â”¤    â—       â—                                  â”‚
â”‚    5.0 â”¤  â—           â—   â—                            â”‚
â”‚    4.5 â”¤â—               â—                              â”‚
â”‚    4.0 â”¤                                               â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚         9æœˆ  10æœˆ  11æœˆ  12æœˆ  1æœˆ   2æœˆ                â”‚
â”‚                                                        â”‚
â”‚  â— é›»è€— (km/kWh)   ğŸ”´ ä½æ–¼ 4.0 è­¦ç¤º                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢                                         â”‚
â”‚                                                        â”‚
â”‚  $/km                                                  â”‚
â”‚   0.80 â”¤            â—                                  â”‚
â”‚   0.70 â”¤    â—   â—                                      â”‚
â”‚   0.60 â”¤  â—           â—   â—                            â”‚
â”‚   0.50 â”¤â—                                              â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚         9æœˆ  10æœˆ  11æœˆ  12æœˆ  1æœˆ   2æœˆ                â”‚
â”‚                                                        â”‚
â”‚  â— æˆæœ¬ ($/km)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.4 ç¨‹å¼ç¢¼å¯¦ä½œç¯„ä¾‹

```swift
// æ–°å¢ï¼šé›»è€—æ•ˆç‡è¶¨å‹¢åœ–ï¼ˆTime Seriesï¼‰
struct EfficiencyTrendChart: View {
    let data: [(month: String, efficiency: Double)]
    @ObservedObject var theme: AppTheme
    
    // ç•°å¸¸å€¼é–¾å€¼
    private let efficiencyWarningThreshold: Double = 4.0
    
    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            Text("é›»è€—æ•ˆç‡è¶¨å‹¢")
                .font(.system(size: 16, weight: .medium))
                .foregroundColor(theme.primaryTextColor)
            
            if data.isEmpty {
                Text("æš«ç„¡è³‡æ–™")
                    .foregroundColor(theme.secondaryTextColor)
                    .frame(maxWidth: .infinity, minHeight: 120)
            } else {
                // ä½¿ç”¨æ™‚é–“ç‚º X è»¸çš„æŠ˜ç·šåœ–
                GeometryReader { geometry in
                    let chartWidth = geometry.size.width - 50
                    let chartHeight = geometry.size.height - 40
                    let maxEff = max(data.map { $0.efficiency }.max() ?? 1, 6.0)
                    let minEff = min(data.map { $0.efficiency }.min() ?? 0, 3.0)
                    let effRange = maxEff - minEff
                    
                    ZStack {
                        // èƒŒæ™¯ç¶²æ ¼
                        drawGrid(chartWidth: chartWidth, chartHeight: chartHeight)
                        
                        // è­¦ç¤ºå€åŸŸï¼ˆä½æ–¼é–¾å€¼ï¼‰
                        drawWarningZone(chartWidth: chartWidth, chartHeight: chartHeight, minEff: minEff, effRange: effRange)
                        
                        // æŠ˜ç·š
                        drawLine(chartWidth: chartWidth, chartHeight: chartHeight, minEff: minEff, effRange: effRange)
                        
                        // è³‡æ–™é»ï¼ˆå«ç•°å¸¸æ¨™è¨»ï¼‰
                        drawPoints(chartWidth: chartWidth, chartHeight: chartHeight, minEff: minEff, effRange: effRange)
                        
                        // Y è»¸æ¨™ç±¤
                        drawYAxisLabels(chartHeight: chartHeight, minEff: minEff, maxEff: maxEff)
                        
                        // X è»¸æ¨™ç±¤ï¼ˆæœˆä»½ï¼‰
                        drawXAxisLabels(chartWidth: chartWidth, chartHeight: chartHeight)
                    }
                }
                .frame(height: 150)
                
                // åœ–ä¾‹
                HStack(spacing: 16) {
                    HStack(spacing: 4) {
                        Circle()
                            .fill(AppTheme.accentPurple)
                            .frame(width: 8, height: 8)
                        Text("é›»è€— (km/kWh)")
                            .font(.system(size: 10))
                            .foregroundColor(theme.secondaryTextColor)
                    }
                    HStack(spacing: 4) {
                        Circle()
                            .fill(Color.red)
                            .frame(width: 8, height: 8)
                        Text("ä½æ–¼ \(String(format: "%.1f", efficiencyWarningThreshold)) è­¦ç¤º")
                            .font(.system(size: 10))
                            .foregroundColor(theme.secondaryTextColor)
                    }
                }
                .padding(.horizontal)
            }
        }
        .padding()
        .background(theme.cardBackgroundColor)
        .cornerRadius(12)
    }
}

// æ–°å¢ï¼šæ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢åœ–
struct CostPerKmTrendChart: View {
    let data: [(month: String, costPerKm: Double)]
    @ObservedObject var theme: AppTheme
    
    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            Text("æ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢")
                .font(.system(size: 16, weight: .medium))
                .foregroundColor(theme.primaryTextColor)
            
            // é¡ä¼¼ EfficiencyTrendChart çš„å¯¦ä½œ
            // X è»¸ï¼šæœˆä»½ï¼ˆæ™‚é–“åºåˆ—ï¼‰
            // Y è»¸ï¼š$/km
        }
        .padding()
        .background(theme.cardBackgroundColor)
        .cornerRadius(12)
    }
}
```

---

### 4.2 æ–°å¢ã€Œæ¯å…¬é‡Œæˆæœ¬ã€æŒ‡æ¨™ï¼ˆP0ï¼‰

#### 4.2.1 éœ€æ±‚èªªæ˜
ç”¨æˆ¶ç›®å‰æœ‰ã€Œç¸½è²»ç”¨ã€èˆ‡ã€Œç¸½é‡Œç¨‹ã€å…©å€‹æŒ‡æ¨™ï¼Œä½†ç¼ºå°‘å…©è€…çš„é—œè¯æŒ‡æ¨™ã€‚ã€Œæ¯å…¬é‡Œæˆæœ¬ã€æ˜¯é›»å‹•è»Šä¸»æœ€åœ¨æ„çš„æ•¸æ“šï¼Œæ–¹ä¾¿èˆ‡æ²¹è»Šæ¯”è¼ƒã€‚

#### 4.2.2 è¨ˆç®—å…¬å¼
```
æ¯å…¬é‡Œæˆæœ¬ ($/km) = ç¸½è²»ç”¨ / ç¸½é‡Œç¨‹
```

#### 4.2.3 UI è¨­è¨ˆ

**æ–¹æ¡ˆ Aï¼šæ–°å¢ç¬¬äº”å¼µå¡ç‰‡**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ ç¸½å……é›»é‡       â”‚  â”‚ ç¸½è²»ç”¨        â”‚                   â”‚
â”‚  â”‚ 45.2 kWh     â”‚  â”‚ $138.88      â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ ç¸½é‡Œç¨‹        â”‚  â”‚ å¹³å‡é›»è€—       â”‚                   â”‚
â”‚  â”‚ 227.6 km     â”‚  â”‚ 5.03 km/kWh  â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ¯ å¹³å‡æ¯å…¬é‡Œæˆæœ¬                                 â”‚    â”‚
â”‚  â”‚      $0.61 / km                                 â”‚    â”‚
â”‚  â”‚      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚    â”‚
â”‚  â”‚      è¼ƒæ²¹è»Šä¾¿å®œç´„ 60%ï¼ˆå‡è¨­æ²¹è»Š $1.5/kmï¼‰         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ–¹æ¡ˆ Bï¼šåœ¨ã€Œå¹³å‡é›»è€—ã€å¡ç‰‡ä¸‹æ–¹æ–°å¢å‰¯è³‡è¨Šï¼ˆæ¨è–¦ï¼‰**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¹³å‡é›»è€—                               â”‚
â”‚ 5.03 km/kWh                          â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ å¹³å‡æˆæœ¬ $0.61/km                      â”‚ â—„â”€â”€ æ–°å¢
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.4 ç¨‹å¼ç¢¼è®Šæ›´

**StatisticsViewModel.swift æ–°å¢ï¼š**
```swift
// å¹³å‡æ¯å…¬é‡Œæˆæœ¬
var averageCostPerKm: Double {
    guard totalMileage > 0 else { return 0 }
    return totalCost / totalMileage
}

// æ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢è³‡æ–™ï¼ˆç”¨æ–¼åœ–è¡¨ï¼‰
var costPerKmTrendData: [(month: String, costPerKm: Double)] {
    return filteredStatistics.compactMap { entry in
        let mileage = entry.stageMileageValue
        let cost = entry.totalCostValue
        guard mileage > 0 else { return nil }
        let monthDisplay = "\(entry.year)/\(entry.month)"
        return (month: monthDisplay, costPerKm: cost / mileage)
    }
}
```

**StatisticsView.swift ä¿®æ”¹ï¼š**
```swift
private var summarySection: some View {
    // æ–¹æ¡ˆ Bï¼šä¿®æ”¹ç¬¬å››å¼µå¡ç‰‡ï¼ŒåŠ å…¥å‰¯è³‡è¨Š
    StatisticsSummaryCard(
        title: "å¹³å‡é›»è€—",
        value: String(format: "%.2f km/kWh", viewModel.averageEfficiency),
        subtitle: String(format: "å¹³å‡æˆæœ¬ $%.2f/km", viewModel.averageCostPerKm),
        color: Color.orange,
        theme: theme
    )
}
```

---

### 4.3 å„ªåŒ–æœˆåº¦å……é›»é‡åœ–è¡¨ï¼ˆP1ï¼‰

#### 4.3.1 éœ€æ±‚èªªæ˜
ç›®å‰çš„æœˆåº¦å……é›»é‡é•·æ¢åœ–åƒ…é¡¯ç¤º kWhï¼Œç„¡æ³•å°æ¯”è²»ç”¨ï¼Œä¹Ÿç„¡æ³•å€åˆ†å……é›»ä¾†æºã€‚

#### 4.3.2 è§£æ±ºæ–¹æ¡ˆ

**æ–¹æ¡ˆ Aï¼šToggle åˆ‡æ›ï¼ˆæ¨è–¦ï¼‰**
- æ–°å¢åˆ‡æ›æŒ‰éˆ•ï¼Œè®“ç”¨æˆ¶å¯ä»¥åœ¨ã€Œåº¦æ•¸ (kWh)ã€èˆ‡ã€Œè²»ç”¨ ($)ã€ä¹‹é–“åˆ‡æ›

**æ–¹æ¡ˆ Bï¼šå †ç–Šé•·æ¢åœ–**
- å¦‚æœè³‡æ–™æœ‰å€åˆ† AC/DCï¼Œå¯ç”¨ä¸åŒé¡è‰²å †ç–Šé¡¯ç¤º

#### 4.3.3 UI è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœˆåº¦å……é›»é‡                     [kWh â–¼] â—„â”€â”€ åˆ‡æ›é¸å–®     â”‚
â”‚                                                         â”‚
â”‚     kWh (åˆ‡æ›å¾Œé¡¯ç¤º $ è²»ç”¨)                              â”‚
â”‚      â”‚                                                  â”‚
â”‚   60 â”¤     â–ˆâ–ˆâ–ˆâ–ˆ                                         â”‚
â”‚   50 â”¤     â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                                   â”‚
â”‚   40 â”¤â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                             â”‚
â”‚   30 â”¤â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                       â”‚
â”‚   20 â”¤â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ                 â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚
â”‚        9æœˆ   10æœˆ  11æœˆ   12æœˆ   1æœˆ   2æœˆ               â”‚
â”‚                                                         â”‚
â”‚  é¸é …ï¼škWhï¼ˆåº¦æ•¸ï¼‰| $ï¼ˆè²»ç”¨ï¼‰                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.4 ç¨‹å¼ç¢¼å¯¦ä½œ

```swift
// ChartViews.swift

struct MonthlyChargedChart: View {
    let chargedData: [(month: String, value: Double)]
    let costData: [(month: String, value: Double)]
    @ObservedObject var theme: AppTheme
    
    enum DisplayMode: String, CaseIterable {
        case kWh = "kWh"
        case cost = "$"
        
        var displayName: String {
            switch self {
            case .kWh: return "åº¦æ•¸ (kWh)"
            case .cost: return "è²»ç”¨ ($)"
            }
        }
    }
    
    @State private var displayMode: DisplayMode = .kWh
    
    private var currentData: [(month: String, value: Double)] {
        switch displayMode {
        case .kWh: return chargedData
        case .cost: return costData
        }
    }
    
    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            // æ¨™é¡Œåˆ—å«åˆ‡æ›é¸å–®
            HStack {
                Text("æœˆåº¦å……é›»é‡")
                    .font(.system(size: 16, weight: .medium))
                    .foregroundColor(theme.primaryTextColor)
                
                Spacer()
                
                // åˆ‡æ›é¸å–®
                Picker("é¡¯ç¤ºæ¨¡å¼", selection: $displayMode) {
                    ForEach(DisplayMode.allCases, id: \.self) { mode in
                        Text(mode.displayName).tag(mode)
                    }
                }
                .pickerStyle(MenuPickerStyle())
                .accentColor(AppTheme.accentPurple)
            }
            
            // åœ–è¡¨æœ¬é«”ï¼ˆä½¿ç”¨ currentDataï¼‰
            // ...existing chart code with currentData...
        }
    }
}
```

---

### 4.4 æ–°å¢å……é›»ä¾†æºåˆ†æï¼ˆP1ï¼‰

#### 4.4.1 éœ€æ±‚èªªæ˜
å€åˆ† ACï¼ˆå®¶å……/æ…¢å……ï¼‰èˆ‡ DCï¼ˆè¶…å……/å¿«å……ï¼‰çš„æ¯”ä¾‹ï¼Œè®“ç”¨æˆ¶äº†è§£å……é›»å ´æ™¯åˆ†å¸ƒã€‚

#### 4.4.2 è³‡æ–™ä¾†æº
æ ¹æ“š `ChargedLogEntry` çš„ `chargerType` æ¬„ä½åˆ¤æ–·ï¼š
- **AC**ï¼š`ACSingleWireCAN`ã€`J1772`
- **DC**ï¼š`Supercharger`

#### 4.4.3 UI è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å……é›»ä¾†æºåˆ†å¸ƒ                    [kWh â–¼] â—„â”€â”€ åˆ‡æ›       â”‚
â”‚                                                         â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚        â”‚                                â”‚               â”‚
â”‚        â”‚       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ               â”‚               â”‚
â”‚        â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          â”‚               â”‚
â”‚        â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å®¶å…… â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          â”‚               â”‚
â”‚        â”‚    â–ˆâ–ˆ 90% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ           â”‚               â”‚
â”‚        â”‚       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ è¶…å……            â”‚               â”‚
â”‚        â”‚          10%                   â”‚               â”‚
â”‚        â”‚                                â”‚               â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  â–  å®¶å…… (AC)ï¼š40.7 kWh (90%)                            â”‚
â”‚  â–  è¶…å…… (DC)ï¼š4.5 kWh (10%)                             â”‚
â”‚                                                         â”‚
â”‚  åˆ‡æ›ï¼šåº¦æ•¸ (kWh) | è²»ç”¨ ($)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.4.4 è³‡æ–™æ¨¡å‹æ“´å……

**StatisticsViewModel.swift æ–°å¢ï¼š**
```swift
// å……é›»ä¾†æºçµ±è¨ˆ
struct ChargeSourceStats {
    let acKWh: Double
    let dcKWh: Double
    let acCost: Double
    let dcCost: Double
    
    var acKWhRatio: Double {
        let total = acKWh + dcKWh
        guard total > 0 else { return 0 }
        return acKWh / total
    }
    
    var dcKWhRatio: Double {
        let total = acKWh + dcKWh
        guard total > 0 else { return 0 }
        return dcKWh / total
    }
    
    var acCostRatio: Double {
        let total = acCost + dcCost
        guard total > 0 else { return 0 }
        return acCost / total
    }
    
    var dcCostRatio: Double {
        let total = acCost + dcCost
        guard total > 0 else { return 0 }
        return dcCost / total
    }
}

// è¨ˆç®—å……é›»ä¾†æºçµ±è¨ˆï¼ˆéœ€è¦è©³ç´° Log è³‡æ–™ï¼‰
var chargeSourceStats: ChargeSourceStats {
    // æ­¤åŠŸèƒ½éœ€è¦å¾ ChargedLogEntry é€ç­†è¨ˆç®—
    // æ ¹æ“š chargerType åˆ¤æ–· AC/DC
    // ...
}
```

#### 4.4.5 ç¨‹å¼ç¢¼å¯¦ä½œ

```swift
// æ–°å¢ï¼šå……é›»ä¾†æºåœ“é¤…åœ–
struct ChargeSourcePieChart: View {
    let acValue: Double
    let dcValue: Double
    let mode: DisplayMode // kWh æˆ– $
    @ObservedObject var theme: AppTheme
    
    enum DisplayMode {
        case kWh, cost
    }
    
    private var total: Double { acValue + dcValue }
    private var acRatio: Double { total > 0 ? acValue / total : 0 }
    private var dcRatio: Double { total > 0 ? dcValue / total : 0 }
    
    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            Text("å……é›»ä¾†æºåˆ†å¸ƒ")
                .font(.system(size: 16, weight: .medium))
                .foregroundColor(theme.primaryTextColor)
            
            HStack(spacing: 20) {
                // åœ“é¤…åœ–
                ZStack {
                    // AC éƒ¨åˆ†
                    Circle()
                        .trim(from: 0, to: acRatio)
                        .stroke(Color.green, lineWidth: 20)
                        .rotationEffect(.degrees(-90))
                    
                    // DC éƒ¨åˆ†
                    Circle()
                        .trim(from: acRatio, to: 1)
                        .stroke(AppTheme.teslaRed, lineWidth: 20)
                        .rotationEffect(.degrees(-90))
                }
                .frame(width: 100, height: 100)
                
                // åœ–ä¾‹
                VStack(alignment: .leading, spacing: 8) {
                    HStack {
                        Circle()
                            .fill(Color.green)
                            .frame(width: 12, height: 12)
                        Text(String(format: "å®¶å…… (AC)ï¼š%.1f %@", acValue, mode == .kWh ? "kWh" : "å…ƒ"))
                            .font(.system(size: 12))
                            .foregroundColor(theme.primaryTextColor)
                        Text(String(format: "(%.0f%%)", acRatio * 100))
                            .font(.system(size: 12))
                            .foregroundColor(theme.secondaryTextColor)
                    }
                    
                    HStack {
                        Circle()
                            .fill(AppTheme.teslaRed)
                            .frame(width: 12, height: 12)
                        Text(String(format: "è¶…å…… (DC)ï¼š%.1f %@", dcValue, mode == .kWh ? "kWh" : "å…ƒ"))
                            .font(.system(size: 12))
                            .foregroundColor(theme.primaryTextColor)
                        Text(String(format: "(%.0f%%)", dcRatio * 100))
                            .font(.system(size: 12))
                            .foregroundColor(theme.secondaryTextColor)
                    }
                }
            }
        }
        .padding()
        .background(theme.cardBackgroundColor)
        .cornerRadius(12)
    }
}
```

---

### 4.5 ç•°å¸¸å€¼æ¨™è¨»åŠŸèƒ½ï¼ˆP2ï¼‰

#### 4.5.1 éœ€æ±‚èªªæ˜
æ ¹æ“šç”¨æˆ¶è³‡æ–™ï¼Œé›»è€—æ³¢å‹•ç¯„åœå¯èƒ½å¾ 3.7 åˆ° 5.9 km/kWhã€‚ç•¶å‡ºç¾ç•°å¸¸å€¼æ™‚ï¼Œæ‡‰è‡ªå‹•åœ¨åœ–è¡¨ä¸Šæ¨™è¨»ï¼Œå¹«åŠ©ç”¨æˆ¶å›æƒ³ç•¶æ™‚çš„é§•é§›æƒ…æ³ã€‚

#### 4.5.2 ç•°å¸¸é–¾å€¼å®šç¾©

| é¡å‹ | é–¾å€¼ | æ¨™è¨»é¡è‰² |
|------|------|----------|
| ä½é›»è€—ï¼ˆç•°å¸¸å·®ï¼‰ | < 4.0 km/kWh | ç´…è‰² |
| é«˜é›»è€—ï¼ˆç•°å¸¸å¥½ï¼‰ | > 5.5 km/kWh | ç¶ è‰² |
| æ­£å¸¸ç¯„åœ | 4.0 ~ 5.5 km/kWh | ç´«è‰²ï¼ˆé è¨­ï¼‰ |

#### 4.5.3 è¦–è¦ºå‘ˆç¾

```
é›»è€—æ•ˆç‡è¶¨å‹¢
  km/kWh
    6.0 â”¤        ğŸŸ¢            â—„â”€â”€ ç•°å¸¸é«˜ï¼ˆç¶ é»ï¼‰
    5.5 â”¤    â—       â—
    5.0 â”¤  â—           â—   â—
    4.5 â”¤                   
    4.0 â”¤â—                    â—„â”€â”€ è­¦ç¤ºç·š
    3.8 â”¤               ğŸ”´    â—„â”€â”€ ç•°å¸¸ä½ï¼ˆç´…é»ï¼‰
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         9æœˆ  10æœˆ  11æœˆ  12æœˆ 
```

#### 4.5.4 ç¨‹å¼ç¢¼å¯¦ä½œ

```swift
// åœ¨ EfficiencyTrendChart ä¸­
private func pointColor(for efficiency: Double) -> Color {
    if efficiency < 4.0 {
        return .red  // ç•°å¸¸ä½
    } else if efficiency > 5.5 {
        return .green  // ç•°å¸¸é«˜
    } else {
        return AppTheme.accentPurple  // æ­£å¸¸
    }
}

// ç¹ªè£½è³‡æ–™é»æ™‚ä½¿ç”¨å‹•æ…‹é¡è‰²
ForEach(Array(data.enumerated()), id: \.offset) { index, point in
    Circle()
        .fill(pointColor(for: point.efficiency))
        .frame(width: point.efficiency < 4.0 || point.efficiency > 5.5 ? 10 : 8, height: point.efficiency < 4.0 || point.efficiency > 5.5 ? 10 : 8)
        .position(x: x, y: y)
}
```

---

### 4.6 å„€è¡¨æ¿ä½ˆå±€èª¿æ•´ï¼ˆP2ï¼‰

#### 4.6.1 å„ªåŒ–å¾Œä½ˆå±€æ§‹æƒ³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     çµ±è¨ˆé é¢                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å¹´ä»½ â–¼]              [æ™‚é–“ç¯„åœ â–¼]                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ ç¸½é›»é‡        â”‚  â”‚ ç¸½è²»ç”¨        â”‚                   â”‚
â”‚  â”‚ 45.2 kWh     â”‚  â”‚ $138.88      â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ ç¸½é‡Œç¨‹        â”‚  â”‚ å¹³å‡æˆæœ¬       â”‚ â—„â”€â”€ æ”¹ç‚ºæˆæœ¬å„ªå…ˆ  â”‚
â”‚  â”‚ 227.6 km     â”‚  â”‚ $0.61/km     â”‚                   â”‚
â”‚  â”‚              â”‚  â”‚ 5.03 km/kWh  â”‚ â—„â”€â”€ é›»è€—ç‚ºå‰¯è³‡è¨Š  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ æœˆåº¦å……é›»é‡                      [kWh â–¼]        â”‚    â”‚
â”‚  â”‚ (é•·æ¢åœ–ï¼Œå¯åˆ‡æ› kWh/è²»ç”¨)                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ é›»è€—æ•ˆç‡è¶¨å‹¢                                    â”‚    â”‚
â”‚  â”‚ (æŠ˜ç·šåœ–ï¼ŒXè»¸ç‚ºæ™‚é–“ï¼Œå«ç•°å¸¸æ¨™è¨»)                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ æ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢                                   â”‚    â”‚
â”‚  â”‚ (æŠ˜ç·šåœ–ï¼ŒXè»¸ç‚ºæ™‚é–“)                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ å……é›»ä¾†æºåˆ†å¸ƒ                    [kWh â–¼]        â”‚    â”‚
â”‚  â”‚ (åœ“é¤…åœ–ï¼ŒAC vs DC)                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. æŠ€è¡“å¯¦ä½œå»ºè­°

### 5.1 æ–°å¢æª”æ¡ˆ
| æª”æ¡ˆ | èªªæ˜ |
|------|------|
| ç„¡ | æ‰€æœ‰åœ–è¡¨æ•´åˆè‡³ `ChartViews.swift` |

### 5.2 ä¿®æ”¹æª”æ¡ˆ

| æª”æ¡ˆ | ä¿®æ”¹å…§å®¹ |
|------|---------|
| `ChartViews.swift` | æ–°å¢ `EfficiencyTrendChart`ã€`CostPerKmTrendChart`ã€`ChargeSourcePieChart`ï¼›ä¿®æ”¹ `MonthlyChargedChart` æ”¯æ´åˆ‡æ› |
| `StatisticsViewModel.swift` | æ–°å¢ `averageCostPerKm`ã€`costPerKmTrendData`ã€`efficiencyTrendData`ã€`chargeSourceStats` è¨ˆç®—å±¬æ€§ |
| `StatisticsView.swift` | èª¿æ•´å¡ç‰‡å€èˆ‡åœ–è¡¨å€ä½ˆå±€ï¼Œæ•´åˆæ–°åœ–è¡¨ |
| `StatisticsEntry.swift` | å¦‚éœ€æ”¯æ´ AC/DC å€åˆ†ï¼Œå¯èƒ½éœ€è¦æ“´å……è³‡æ–™æ¨¡å‹ |

### 5.3 è³‡æ–™éœ€æ±‚

è‹¥è¦æ”¯æ´ã€Œå……é›»ä¾†æºåˆ†æã€ï¼ˆAC vs DCï¼‰ï¼Œéœ€è¦ç¢ºèªè³‡æ–™ä¾†æºï¼š

**æ–¹æ¡ˆ Aï¼šå¾ StatisticsEntry æ“´å……ï¼ˆéœ€å¾Œç«¯é…åˆï¼‰**
- æ–°å¢ `acChargedKWh`ã€`dcChargedKWh`ã€`acCost`ã€`dcCost` æ¬„ä½

**æ–¹æ¡ˆ Bï¼šå¾ ChargedLogEntry å³æ™‚è¨ˆç®—**
- æ ¹æ“š `chargerType` é€ç­†åŠ ç¸½
- å„ªé»ï¼šä¸éœ€å¾Œç«¯æ”¹å‹•
- ç¼ºé»ï¼šéœ€é¡å¤–è¼‰å…¥ Log è³‡æ–™

---

## 6. æ¸¬è©¦æ¡ˆä¾‹

| æ¸¬è©¦é …ç›® | é æœŸçµæœ |
|---------|---------|
| é›»è€—æ•ˆç‡è¶¨å‹¢åœ– | X è»¸ç‚ºæœˆä»½ï¼ˆæ™‚é–“åºåˆ—ï¼‰ï¼ŒY è»¸ç‚º km/kWh |
| é›»è€—ç•°å¸¸æ¨™è¨» | ä½æ–¼ 4.0 é¡¯ç¤ºç´…é»ï¼Œé«˜æ–¼ 5.5 é¡¯ç¤ºç¶ é» |
| æ¯å…¬é‡Œæˆæœ¬å¡ç‰‡ | é¡¯ç¤ºæ­£ç¢ºçš„ $/km æ•¸å€¼ |
| æ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢åœ– | X è»¸ç‚ºæœˆä»½ï¼ŒY è»¸ç‚º $/km |
| æœˆåº¦å……é›»é‡åˆ‡æ› | å¯åœ¨ kWh èˆ‡ $ ä¹‹é–“åˆ‡æ›é¡¯ç¤º |
| å……é›»ä¾†æºåœ“é¤…åœ– | æ­£ç¢ºé¡¯ç¤º AC/DC æ¯”ä¾‹ |
| è³‡æ–™ç‚ºç©ºæ™‚ | å„åœ–è¡¨é¡¯ç¤ºã€Œæš«ç„¡è³‡æ–™ã€ |
| ç¯©é¸æ¢ä»¶è®Šæ›´ | æ‰€æœ‰åœ–è¡¨æ­£ç¢ºæ›´æ–° |

---

## 7. å„ªå…ˆç´šèˆ‡æ™‚ç¨‹å»ºè­°

| éšæ®µ | å„ªå…ˆç´š | é …ç›® | é ä¼°å·¥æ™‚ |
|------|--------|------|---------|
| Phase 1 | P0 | ä¿®æ­£åº•éƒ¨åœ–è¡¨é‚è¼¯ï¼ˆé›»è€—è¶¨å‹¢åœ–ï¼‰ | 2h |
| Phase 1 | P0 | æ–°å¢æ¯å…¬é‡Œæˆæœ¬æŒ‡æ¨™èˆ‡è¶¨å‹¢åœ– | 1.5h |
| Phase 2 | P1 | å„ªåŒ–æœˆåº¦å……é›»é‡åœ–è¡¨ï¼ˆToggle åˆ‡æ›ï¼‰ | 1h |
| Phase 2 | P1 | æ–°å¢å……é›»ä¾†æºåˆ†æåœ“é¤…åœ– | 2h |
| Phase 3 | P2 | ç•°å¸¸å€¼æ¨™è¨»åŠŸèƒ½ | 1h |
| Phase 3 | P2 | å„€è¡¨æ¿ä½ˆå±€èª¿æ•´ | 1h |

**ç¸½é ä¼°å·¥æ™‚**ï¼šç´„ 8.5 å°æ™‚

---

## 8. ç›¸é—œæ–‡ä»¶

- [PRD.md](../PRD.md)ï¼šç”¢å“ä¸»è¦è¦æ ¼æ›¸
- [CHANGELOG.md](../CHANGELOG.md)ï¼šç‰ˆæœ¬è®Šæ›´ç´€éŒ„
- [ChargedLogExample.json](../example/ChargedLogExample.json)ï¼šå……é›»ç´€éŒ„è³‡æ–™ç¯„ä¾‹
- [statistics_example.json](../example/statistics_example.json)ï¼šçµ±è¨ˆè³‡æ–™ç¯„ä¾‹

---

## 9. é™„éŒ„ï¼šSwift Charts æ™‚é–“åºåˆ—ç¯„ä¾‹

è‹¥å°ˆæ¡ˆæ”¯æ´ iOS 16+ï¼Œå¯ä½¿ç”¨ Swift Charts æ¡†æ¶å¯¦ä½œæ›´ç²¾ç·»çš„åœ–è¡¨ï¼š

```swift
import Charts

struct EfficiencyTrendChartSwiftCharts: View {
    let data: [EfficiencyDataPoint]
    
    struct EfficiencyDataPoint: Identifiable {
        let id = UUID()
        let date: Date
        let efficiency: Double
    }
    
    var body: some View {
        Chart {
            ForEach(data) { point in
                LineMark(
                    x: .value("Date", point.date, unit: .month),
                    y: .value("Efficiency", point.efficiency)
                )
                .interpolationMethod(.catmullRom)
                .foregroundStyle(Color.purple)
                
                PointMark(
                    x: .value("Date", point.date, unit: .month),
                    y: .value("Efficiency", point.efficiency)
                )
                .foregroundStyle(pointColor(for: point.efficiency))
                .symbolSize(point.efficiency < 4.0 || point.efficiency > 5.5 ? 100 : 60)
            }
            
            // è­¦ç¤ºç·š
            RuleMark(y: .value("Warning", 4.0))
                .foregroundStyle(.red.opacity(0.5))
                .lineStyle(StrokeStyle(lineWidth: 1, dash: [5, 5]))
        }
        .chartYAxis {
            AxisMarks(position: .leading)
        }
        .chartXAxis {
            AxisMarks(values: .stride(by: .month, count: 1)) { value in
                AxisGridLine()
                AxisValueLabel(format: .dateTime.month(.abbreviated))
            }
        }
    }
    
    private func pointColor(for efficiency: Double) -> Color {
        if efficiency < 4.0 { return .red }
        if efficiency > 5.5 { return .green }
        return .purple
    }
}
```

---

## 10. ç‰ˆæœ¬æ­·å²

| ç‰ˆæœ¬ | æ—¥æœŸ | èªªæ˜ |
|------|------|------|
| 1.0 | 2026-02-01 | åˆç‰ˆè¦æ ¼æ›¸ |
| 1.1 | 2026-02-01 | P0/P1 å¯¦ä½œå®Œæˆï¼šé›»è€—æ•ˆç‡è¶¨å‹¢åœ–ã€æ¯å…¬é‡Œæˆæœ¬è¶¨å‹¢åœ–ã€æœˆåº¦åœ–è¡¨åˆ‡æ›ã€å……é›»ä¾†æºåœ“é¤…åœ– |
| 1.2 | 2026-02-01 | P2 å¯¦ä½œå®Œæˆï¼šç•°å¸¸å€¼é¡è‰²æ¨™è¨»ã€å„€è¡¨æ¿ä½ˆå±€èª¿æ•´ã€ç§»é™¤èˆŠ EfficiencyVsCostChart ç¨‹å¼ç¢¼ |
